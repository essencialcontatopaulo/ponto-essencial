<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√Årea do Gestor - Sistema de Ponto</title>
    
    <!-- Reaproveitando seu estilo -->
    <link rel="stylesheet" href="css/style.css?v=2.1.0">
    
    <style>
        /* Estilos espec√≠ficos para gestor */
        .gestor-header {
            background: linear-gradient(90deg, #1b5e20, #2E8B57);
            color: white;
            padding: 25px;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 12px rgba(27, 94, 32, 0.3);
        }
        
        .gestor-welcome {
            font-size: 1.8rem;
            font-weight: 700;
        }
        
        .gestor-email {
            opacity: 0.9;
            font-size: 0.9rem;
            margin-top: 5px;
        }
        
        .gestor-nav {
            background: #f5f5f5;
            padding: 0;
            border-bottom: 2px solid #C8E6C9;
            display: flex;
            overflow-x: auto;
        }
        
        .gestor-tab {
            padding: 18px 25px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            font-size: 16px;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
            color: #555;
        }
        
        .gestor-tab:hover {
            background: rgba(27, 94, 32, 0.05);
        }
        
        .gestor-tab.active {
            background: white;
            border-bottom-color: #1b5e20;
            color: #1b5e20;
            font-weight: 600;
        }
        
        .gestor-content {
            padding: 30px;
            min-height: 500px;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .gestor-section {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 25px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        
        .section-title {
            color: #1b5e20;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #E8F5E9;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .section-title i {
            font-size: 1.5rem;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #dee2e6;
            transition: transform 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        
        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #1b5e20;
            margin: 10px 0;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.95rem;
        }
        
        .photo-capture-area {
            border: 3px dashed #4CAF50;
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            background: #F1F8E9;
            text-align: center;
        }
        
        .camera-container {
            width: 320px;
            height: 240px;
            margin: 20px auto;
            border: 3px solid #333;
            border-radius: 8px;
            overflow: hidden;
            background: #000;
            position: relative;
        }
        
        #cameraVideo, #cameraCanvas {
            width: 100%;
            height: 100%;
        }
        
        .photo-preview {
            max-width: 200px;
            margin: 20px auto;
            border-radius: 10px;
            overflow: hidden;
            border: 3px solid #4CAF50;
            display: none;
        }
        
        .photo-preview img {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .funcionarios-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }
        
        .funcionario-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #E8F5E9;
            transition: all 0.3s;
            position: relative;
        }
        
        .funcionario-card:hover {
            box-shadow: 0 8px 25px rgba(27, 94, 32, 0.1);
            transform: translateY(-3px);
        }
        
        .funcionario-foto {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #4CAF50;
            margin-right: 20px;
            float: left;
        }
        
        .funcionario-info {
            overflow: hidden;
        }
        
        .funcionario-nome {
            font-weight: 600;
            color: #1b5e20;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }
        
        .funcionario-detalhes {
            color: #666;
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
        }
        
        .form-control {
            width: 100%;
            padding: 14px;
            border: 2px solid #C8E6C9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }
        
        .btn-gestor {
            background: linear-gradient(90deg, #1b5e20, #2E8B57);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-gestor:hover {
            background: linear-gradient(90deg, #2E8B57, #388E3C);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(27, 94, 32, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(90deg, #dc3545, #c82333);
        }
        
        .btn-danger:hover {
            background: linear-gradient(90deg, #c82333, #bd2130);
        }
        
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid transparent;
        }
        
        .alert-success {
            background: #d4edda;
            color: #155724;
            border-color: #c3e6cb;
        }
        
        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-color: #bee5eb;
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            color: #666;
            font-style: italic;
        }
        
        .no-data i {
            font-size: 3rem;
            display: block;
            margin-bottom: 15px;
            opacity: 0.5;
        }
        
        /* Responsividade */
        @media (max-width: 768px) {
            .gestor-nav {
                flex-wrap: nowrap;
                overflow-x: auto;
                padding-bottom: 5px;
            }
            
            .gestor-tab {
                padding: 15px 20px;
                font-size: 15px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .funcionarios-grid {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .camera-container {
                width: 100%;
                height: 200px;
            }
        }
        
        /* Anima√ß√µes */
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <!-- Verifica√ß√£o de login -->
    <script>
        // Verificar se o usu√°rio est√° logado como gestor
        if (!localStorage.getItem('gestor_logged_in') || localStorage.getItem('usuario_tipo') !== 'gestor') {
            alert('‚ö†Ô∏è Acesso restrito! Voc√™ precisa estar logado como gestor.');
            window.location.href = 'index.html?v=' + Date.now();
        }
    </script>

    <div class="container">
        <!-- Cabe√ßalho do Gestor -->
        <div class="gestor-header">
            <div>
                <h1 class="gestor-welcome">üëë √Årea do Gestor</h1>
                <div class="gestor-email">
                    Logado como: <strong id="gestorEmail">carregando...</strong>
                </div>
            </div>
            <div>
                <button id="logoutBtn" class="btn-gestor btn-danger" style="padding: 10px 20px;">
                    üö™ Sair
                </button>
            </div>
        </div>
        
        <!-- Navega√ß√£o -->
        <nav class="gestor-nav">
            <button class="gestor-tab active" data-tab="dashboard">üìä Dashboard</button>
            <button class="gestor-tab" data-tab="cadastro">üë§ Cadastrar Funcion√°rio</button>
            <button class="gestor-tab" data-tab="funcionarios">üë• Funcion√°rios</button>
            <button class="gestor-tab" data-tab="ponto">‚è∞ Controle de Ponto</button>
            <button class="gestor-tab" data-tab="relatorios">üìà Relat√≥rios</button>
            <button class="gestor-tab" data-tab="config">‚öôÔ∏è Configura√ß√µes</button>
        </nav>
        
        <!-- Conte√∫do das abas -->
        <div class="gestor-content">
            
            <!-- Dashboard -->
            <div id="dashboard" class="tab-content active">
                <div class="gestor-section">
                    <h2 class="section-title">üìä Dashboard Geral</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">üë•</div>
                            <div class="stat-value" id="totalFuncionarios">0</div>
                            <div class="stat-label">Funcion√°rios Cadastrados</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">‚úÖ</div>
                            <div class="stat-value" id="pontoHoje">0</div>
                            <div class="stat-label">Pontos Hoje</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">‚è∞</div>
                            <div class="stat-value" id="horasTrabalhadas">0h</div>
                            <div class="stat-label">Horas Trabalhadas</div>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">üìà</div>
                            <div class="stat-value" id="presenca">0%</div>
                            <div class="stat-label">Taxa de Presen√ßa</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 40px;">
                        <h3 style="color: #1b5e20; margin-bottom: 20px;">üìã A√ß√µes R√°pidas</h3>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                            <button class="btn-gestor" onclick="abrirAba('cadastro')">
                                üë§ Cadastrar Novo Funcion√°rio
                            </button>
                            <button class="btn-gestor" onclick="abrirAba('funcionarios')">
                                üë• Ver Todos Funcion√°rios
                            </button>
                            <button class="btn-gestor" onclick="gerarRelatorioDiario()">
                                üìä Gerar Relat√≥rio Di√°rio
                            </button>
                            <button class="btn-gestor" onclick="abrirConfiguracoes()">
                                ‚öôÔ∏è Configura√ß√µes do Sistema
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="gestor-section">
                    <h2 class="section-title">üìÖ Pontos Recentes</h2>
                    <div id="pontosRecentes" class="no-data">
                        <div>‚è∞</div>
                        Carregando registros de ponto...
                    </div>
                </div>
            </div>
            
            <!-- Cadastro de Funcion√°rio -->
            <div id="cadastro" class="tab-content">
                <div class="gestor-section">
                    <h2 class="section-title">üë§ Cadastrar Novo Funcion√°rio</h2>
                    
                    <div id="cadastroMessage" class="alert alert-info">
                        üí° <strong>Importante:</strong> A foto √© obrigat√≥ria para o sistema de reconhecimento facial.
                    </div>
                    
                    <form id="formCadastroFuncionario">
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Nome Completo *</label>
                                <input type="text" class="form-control" id="nomeFuncionario" required 
                                       placeholder="Ex: Jo√£o da Silva">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">CPF *</label>
                                <input type="text" class="form-control" id="cpfFuncionario" required 
                                       placeholder="000.000.000-00" maxlength="14">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">E-mail</label>
                                <input type="email" class="form-control" id="emailFuncionario" 
                                       placeholder="funcionario@empresa.com">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Telefone</label>
                                <input type="tel" class="form-control" id="telefoneFuncionario" 
                                       placeholder="(11) 99999-9999">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Cargo *</label>
                                <input type="text" class="form-control" id="cargoFuncionario" required 
                                       placeholder="Ex: Analista de TI">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Departamento *</label>
                                <select class="form-control" id="departamentoFuncionario" required>
                                    <option value="">Selecione...</option>
                                    <option value="ti">TI</option>
                                    <option value="rh">RH</option>
                                    <option value="vendas">Vendas</option>
                                    <option value="financeiro">Financeiro</option>
                                    <option value="producao">Produ√ß√£o</option>
                                    <option value="administrativo">Administrativo</option>
                                    <option value="marketing">Marketing</option>
                                    <option value="outro">Outro</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Data de Admiss√£o *</label>
                                <input type="date" class="form-control" id="admissaoFuncionario" required 
                                       value="<?php echo date('Y-m-d'); ?>">
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Sal√°rio Base (R$)</label>
                                <input type="number" class="form-control" id="salarioFuncionario" 
                                       placeholder="3000.00" step="0.01">
                            </div>
                        </div>
                        
                        <!-- CAPTURA DE FOTO (OBRIGAT√ìRIA) -->
                        <div class="photo-capture-area">
                            <h3 style="color: #1b5e20; margin-bottom: 15px;">üì∏ Foto para Reconhecimento Facial *</h3>
                            <p style="color: #666; margin-bottom: 20px; max-width: 600px; margin-left: auto; margin-right: auto;">
                                <strong>Esta foto ser√° usada pelo sistema de ponto eletr√¥nico.</strong><br>
                                Certifique-se de que o rosto esteja bem iluminado, vis√≠vel e centralizado.
                            </p>
                            
                            <div class="camera-container">
                                <video id="cameraVideo" autoplay playsinline></video>
                                <canvas id="cameraCanvas" style="display: none;"></canvas>
                            </div>
                            
                            <div style="margin: 20px 0;">
                                <button type="button" id="btnLigarCamera" class="btn-gestor pulse">
                                    üé• Ligar C√¢mera
                                </button>
                                <button type="button" id="btnCapturarFoto" class="btn-gestor" disabled style="background: #4CAF50;">
                                    üì∏ Capturar Foto
                                </button>
                                <button type="button" id="btnNovaFoto" class="btn-gestor" style="display: none; background: #FF9800;">
                                    üîÑ Tirar Nova Foto
                                </button>
                            </div>
                            
                            <div id="photoStatus" style="color: #666; margin: 15px 0; min-height: 24px;">
                                Aguardando captura da foto...
                            </div>
                            
                            <div class="photo-preview" id="photoPreview">
                                <img id="previewImage" src="" alt="Preview da Foto">
                            </div>
                            
                            <input type="hidden" id="fotoBase64" required>
                        </div>
                        
                        <div style="margin-top: 40px; text-align: center;">
                            <button type="submit" class="btn-gestor" style="padding: 18px 40px; font-size: 18px;">
                                üíæ Salvar Funcion√°rio
                            </button>
                            <button type="reset" class="btn-gestor" style="background: #6c757d; margin-left: 15px;">
                                üóëÔ∏è Limpar Formul√°rio
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- Funcion√°rios Cadastrados -->
            <div id="funcionarios" class="tab-content">
                <div class="gestor-section">
                    <h2 class="section-title">üë• Funcion√°rios Cadastrados</h2>
                    
                    <div style="margin-bottom: 25px; display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <input type="text" id="searchFuncionario" class="form-control" 
                                   placeholder="üîç Buscar funcion√°rio por nome, CPF ou cargo..." 
                                   style="width: 350px;">
                        </div>
                        <button class="btn-gestor" onclick="exportarFuncionarios()">
                            üì• Exportar Lista
                        </button>
                    </div>
                    
                    <div id="listaFuncionarios" class="funcionarios-grid">
                        <!-- Lista ser√° carregada aqui -->
                        <div class="no-data">
                            <div>üë•</div>
                            Nenhum funcion√°rio cadastrado ainda.<br>
                            <button class="btn-gestor" onclick="abrirAba('cadastro')" 
                                    style="margin-top: 15px; padding: 10px 20px;">
                                üë§ Cadastrar Primeiro Funcion√°rio
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Controle de Ponto -->
            <div id="ponto" class="tab-content">
                <div class="gestor-section">
                    <h2 class="section-title">‚è∞ Controle de Ponto</h2>
                    <p>Visualize e gerencie os registros de ponto dos funcion√°rios.</p>
                    
                    <div style="margin: 25px 0;">
                        <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                            <label class="form-label">Data:</label>
                            <input type="date" id="dataPonto" class="form-control" 
                                   style="width: 200px;" value="<?php echo date('Y-m-d'); ?>">
                            
                            <label class="form-label" style="margin-left: 20px;">Departamento:</label>
                            <select id="departamentoPonto" class="form-control" style="width: 200px;">
                                <option value="todos">Todos os Departamentos</option>
                                <option value="ti">TI</option>
                                <option value="rh">RH</option>
                                <option value="vendas">Vendas</option>
                                <option value="financeiro">Financeiro</option>
                            </select>
                            
                            <button class="btn-gestor" onclick="carregarPontos()">
                                üîç Filtrar
                            </button>
                        </div>
                    </div>
                    
                    <div id="tabelaPontos">
                        <div class="no-data">
                            <div>‚è∞</div>
                            Carregando registros de ponto...
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Relat√≥rios -->
            <div id="relatorios" class="tab-content">
                <div class="gestor-section">
                    <h2 class="section-title">üìà Relat√≥rios</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-card" onclick="gerarRelatorio('diario')" style="cursor: pointer;">
                            <div class="stat-icon">üìÖ</div>
                            <div class="stat-label">Relat√≥rio Di√°rio</div>
                            <p style="color: #666; font-size: 0.9rem; margin-top: 10px;">
                                Pontos do dia atual
                            </p>
                        </div>
                        
                        <div class="stat-card" onclick="gerarRelatorio('mensal')" style="cursor: pointer;">
                            <div class="stat-icon">üìä</div>
                            <div class="stat-label">Relat√≥rio Mensal</div>
                            <p style="color: #666; font-size: 0.9rem; margin-top: 10px;">
                                Resumo do m√™s atual
                            </p>
                        </div>
                        
                        <div class="stat-card" onclick="gerarRelatorio('funcionario')" style="cursor: pointer;">
                            <div class="stat-icon">üë§</div>
                            <div class="stat-label">Por Funcion√°rio</div>
                            <p style="color: #666; font-size: 0.9rem; margin-top: 10px;">
                                Hist√≥rico individual
                            </p>
                        </div>
                        
                        <div class="stat-card" onclick="gerarRelatorio('horas_extras')" style="cursor: pointer;">
                            <div class="stat-icon">üí∞</div>
                            <div class="stat-label">Horas Extras</div>
                            <p style="color: #666; font-size: 0.9rem; margin-top: 10px;">
                                C√°lculo de adicional
                            </p>
                        </div>
                    </div>
                    
                    <div style="margin-top: 40px;">
                        <h3 style="color: #1b5e20; margin-bottom: 20px;">üìã Gerar Relat√≥rio Personalizado</h3>
                        <div style="background: #F8F9FA; padding: 25px; border-radius: 10px; border: 1px solid #E8F5E9;">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                                <div>
                                    <label class="form-label">Data Inicial</label>
                                    <input type="date" id="dataInicio" class="form-control" 
                                           value="<?php echo date('Y-m-01'); ?>">
                                </div>
                                
                                <div>
                                    <label class="form-label">Data Final</label>
                                    <input type="date" id="dataFim" class="form-control" 
                                           value="<?php echo date('Y-m-d'); ?>">
                                </div>
                                
                                <div>
                                    <label class="form-label">Departamento</label>
                                    <select id="relatorioDepartamento" class="form-control">
                                        <option value="todos">Todos</option>
                                        <option value="ti">TI</option>
                                        <option value="rh">RH</option>
                                        <option value="vendas">Vendas</option>
                                    </select>
                                </div>
                                
                                <div>
                                    <label class="form-label">Formato</label>
                                    <select id="formatoRelatorio" class="form-control">
                                        <option value="pdf">PDF</option>
                                        <option value="excel">Excel</option>
                                        <option value="html">HTML</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div style="margin-top: 25px; text-align: center;">
                                <button class="btn-gestor" onclick="gerarRelatorioPersonalizado()" 
                                        style="padding: 15px 40px;">
                                    üöÄ Gerar Relat√≥rio
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Configura√ß√µes -->
            <div id="config" class="tab-content">
                <div class="gestor-section">
                    <h2 class="section-title">‚öôÔ∏è Configura√ß√µes do Sistema</h2>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Nome da Empresa</label>
                            <input type="text" class="form-control" id="nomeEmpresa" 
                                   placeholder="Nome da sua empresa">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Hor√°rio Padr√£o de Entrada</label>
                            <input type="time" class="form-control" id="horarioEntrada" 
                                   value="08:00">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Hor√°rio Padr√£o de Sa√≠da</label>
                            <input type="time" class="form-control" id="horarioSaida" 
                                   value="18:00">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Toler√¢ncia de Atraso (minutos)</label>
                            <input type="number" class="form-control" id="toleranciaAtraso" 
                                   value="10" min="0" max="60">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Dias de Trabalho</label>
                            <div style="margin-top: 10px;">
                                <label style="display: inline-block; margin-right: 15px;">
                                    <input type="checkbox" name="diasTrabalho" value="1" checked> Seg
                                </label>
                                <label style="display: inline-block; margin-right: 15px;">
                                    <input type="checkbox" name="diasTrabalho" value="2" checked> Ter
                                </label>
                                <label style="display: inline-block; margin-right: 15px;">
                                    <input type="checkbox" name="diasTrabalho" value="3" checked> Qua
                                </label>
                                <label style="display: inline-block; margin-right: 15px;">
                                    <input type="checkbox" name="diasTrabalho" value="4" checked> Qui
                                </label>
                                <label style="display: inline-block; margin-right: 15px;">
                                    <input type="checkbox" name="diasTrabalho" value="5" checked> Sex
                                </label>
                                <label style="display: inline-block; margin-right: 15px;">
                                    <input type="checkbox" name="diasTrabalho" value="6"> S√°b
                                </label>
                                <label style="display: inline-block;">
                                    <input type="checkbox" name="diasTrabalho" value="0"> Dom
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 40px; border-top: 2px solid #E8F5E9; padding-top: 30px;">
                        <h3 style="color: #1b5e20; margin-bottom: 20px;">‚ö° A√ß√µes do Sistema</h3>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                            <button class="btn-gestor" onclick="backupDados()">
                                üíæ Backup dos Dados
                            </button>
                            <button class="btn-gestor" onclick="limparCache()" style="background: #FF9800;">
                                üóëÔ∏è Limpar Cache
                            </button>
                            <button class="btn-gestor" onclick="resetarSistema()" class="btn-danger">
                                üîÑ Resetar Sistema
                            </button>
                            <button class="btn-gestor" onclick="atualizarSistema()" style="background: #2196F3;">
                                üîÑ Atualizar Sistema
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
        
        <footer style="margin-top: 40px; text-align: center; padding: 20px; color: #666; border-top: 1px solid #E8F5E9;">
            <p>Sistema de Ponto Eletr√¥nico ¬© 2024 - √Årea do Gestor</p>
            <p style="font-size: 0.9rem; margin-top: 5px;">
                Vers√£o 2.1.0 | √öltimo acesso: <span id="ultimoAcesso">carregando...</span>
            </p>
        </footer>
    </div>

    <!-- JavaScript -->
    <script src="js/utils.js?v=2.1.0"></script>
    
    <script>
        // ============================================
        // SISTEMA DA √ÅREA DO GESTOR
        // ============================================
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log("üëë √Årea do gestor carregada!");
            
            // Configurar usu√°rio
            const gestorEmail = localStorage.getItem('gestor_email') || 
                               localStorage.getItem('usuario_nome') + '@empresa.com';
            document.getElementById('gestorEmail').textContent = gestorEmail;
            
            // Atualizar √∫ltimo acesso
            document.getElementById('ultimoAcesso').textContent = 
                new Date().toLocaleString('pt-BR');
            
            // Configurar navega√ß√£o por abas
            configurarAbas();
            
            // Carregar dashboard
            carregarDashboard();
            
            // Configurar cadastro de funcion√°rio
            configurarCadastroFuncionario();
            
            // Configurar logout
            document.getElementById('logoutBtn').addEventListener('click', function() {
                if (confirm('Deseja realmente sair da √°rea do gestor?')) {
                    localStorage.removeItem('gestor_logged_in');
                    window.location.href = 'index.html?v=' + Date.now();
                }
            });
        });
        
        // ==================== NAVEGA√á√ÉO POR ABAS ====================
        function configurarAbas() {
            const tabs = document.querySelectorAll('.gestor-tab');
            const contents = document.querySelectorAll('.tab-content');
            
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // Remover active de todos
                    tabs.forEach(t => t.classList.remove('active'));
                    contents.forEach(c => c.classList.remove('active'));
                    
                    // Adicionar ao clicado
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                    
                    // Carregar conte√∫do espec√≠fico
                    switch(tabId) {
                        case 'funcionarios':
                            carregarFuncionarios();
                            break;
                        case 'ponto':
                            carregarPontos();
                            break;
                        case 'relatorios':
                            carregarRelatorios();
                            break;
                    }
                });
            });
        }
        
        function abrirAba(abaId) {
            document.querySelectorAll('.gestor-tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('data-tab') === abaId) {
                    tab.classList.add('active');
                }
            });
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                if (content.id === abaId) {
                    content.classList.add('active');
                    
                    // Carregar conte√∫do
                    switch(abaId) {
                        case 'funcionarios':
                            carregarFuncionarios();
                            break;
                        case 'ponto':
                            carregarPontos();
                            break;
                    }
                }
            });
        }
        
        // ==================== DASHBOARD ====================
        function carregarDashboard() {
            // Simular dados
            const funcionarios = JSON.parse(localStorage.getItem('funcionarios') || '[]');
            
            document.getElementById('totalFuncionarios').textContent = funcionarios.length;
            document.getElementById('pontoHoje').textContent = Math.floor(Math.random() * funcionarios.length);
            document.getElementById('horasTrabalhadas').textContent = '160h';
            document.getElementById('presenca').textContent = '95%';
            
            // Carregar pontos recentes
            const pontosRecentesDiv = document.getElementById('pontosRecentes');
            if (funcionarios.length > 0) {
                const html = `
                    <div style="overflow-x: auto;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #E8F5E9;">
                                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #C8E6C9;">Funcion√°rio</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #C8E6C9;">Hor√°rio</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #C8E6C9;">Tipo</th>
                                    <th style="padding: 12px; text-align: left; border-bottom: 2px solid #C8E6C9;">Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${funcionarios.slice(0, 5).map((func, index) => `
                                    <tr style="${index % 2 === 0 ? 'background: #f9f9f9;' : ''}">
                                        <td style="padding: 12px; border-bottom: 1px solid #E8F5E9;">${func.nome}</td>
                                        <td style="padding: 12px; border-bottom: 1px solid #E8F5E9;">${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</td>
                                        <td style="padding: 12px; border-bottom: 1px solid #E8F5E9;">${index % 2 === 0 ? 'Entrada' : 'Sa√≠da'}</td>
                                        <td style="padding: 12px; border-bottom: 1px solid #E8F5E9;">
                                            <span style="color: ${index % 2 === 0 ? '#4CAF50' : '#2196F3'}; font-weight: bold;">
                                                ${index % 2 === 0 ? '‚úÖ Presente' : 'üö™ Saiu'}
                                            </span>
                                        </td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                `;
                pontosRecentesDiv.innerHTML = html;
            }
        }
        
        // ==================== CADASTRO DE FUNCION√ÅRIO ====================
        function configurarCadastroFuncionario() {
            const form = document.getElementById('formCadastroFuncionario');
            const btnLigarCamera = document.getElementById('btnLigarCamera');
            const btnCapturarFoto = document.getElementById('btnCapturarFoto');
            const btnNovaFoto = document.getElementById('btnNovaFoto');
            const video = document.getElementById('cameraVideo');
            const canvas = document.getElementById('cameraCanvas');
            const photoStatus = document.getElementById('photoStatus');
            const previewDiv = document.getElementById('photoPreview');
            const previewImg = document.getElementById('previewImage');
            const fotoInput = document.getElementById('fotoBase64');
            
            let stream = null;
            let fotoCapturada = null;
            
            // Ligar c√¢mera
            btnLigarCamera.addEventListener('click', async function() {
                try {
                    stream = await navigator.mediaDevices.getUserMedia({ 
                        video: { 
                            facingMode: 'user',
                            width: { ideal: 640 },
                            height: { ideal: 480 }
                        } 
                    });
                    
                    video.srcObject = stream;
                    btnCapturarFoto.disabled = false;
                    btnLigarCamera.disabled = true;
                    btnLigarCamera.textContent = 'üé• C√¢mera Ligada';
                    photoStatus.textContent = 'C√¢mera pronta! Posicione o rosto e clique em "Capturar Foto"';
                    photoStatus.style.color = '#4CAF50';
                    
                } catch (error) {
                    console.error('Erro ao acessar c√¢mera:', error);
                    photoStatus.textContent = '‚ùå Erro ao acessar c√¢mera. Verifique as permiss√µes.';
                    photoStatus.style.color = '#f44336';
                    
                    // Simular foto para desenvolvimento
                    fotoCapturada = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIwIiBoZWlnaHQ9IjI0MCIgdmlld0JveD0iMCAwIDMyMCAyNDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjMyMCIgaGVpZ2h0PSIyNDAiIGZpbGw9IiNGRkZGRkUiLz48Y2lyY2xlIGN4PSIxNjAiIGN5PSIxMDAiIHI9IjUwIiBmaWxsPSIjQ0NDQ0NDIi8+PHBhdGggZD0iTTIwMCAxNjBIMTIwQzExMCAxNjAgMTAwIDE3MCAxMDAgMTgwVjIwMEMxMDAgMjEwIDExMCAyMjAgMTIwIDIyMEgyMDBDMjEwIDIyMCAyMjAgMjEwIDIyMCAyMDBWMTgwQzIyMCAxNzAgMjEwIDE2MCAyMDAgMTYwWiIgZmlsbD0iI0NDQ0NDQyIvPjwvc3ZnPg==';
                    fotoInput.value = fotoCapturada;
                    previewImg.src = fotoCapturada;
                    previewDiv.style.display = 'block';
                    photoStatus.textContent = '‚ö†Ô∏è Modo simula√ß√£o ativo - Foto de exemplo carregada';
                    photoStatus.style.color = '#FF9800';
                    btnNovaFoto.style.display = 'inline-block';
                }
            });
            
            // Capturar foto
            btnCapturarFoto.addEventListener('click', function() {
                if (!stream) return;
                
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                
                // Converter para base64
                fotoCapturada = canvas.toDataURL('image/jpeg', 0.8);
                fotoInput.value = fotoCapturada;
                
                // Mostrar preview
                previewImg.src = fotoCapturada;
                previewDiv.style.display = 'block';
                
                // Atualizar status
                photoStatus.textContent = '‚úÖ Foto capturada com sucesso!';
                photoStatus.style.color = '#4CAF50';
                
                // Mostrar bot√£o de nova foto
                btnNovaFoto.style.display = 'inline-block';
                btnCapturarFoto.disabled = true;
                
                // Parar c√¢mera
                if (stream) {
                    stream.getTracks().forEach(track => track.stop());
                }
            });
            
            // Nova foto
            btnNovaFoto.addEventListener('click', function() {
                fotoCapturada = null;
                fotoInput.value = '';
                previewDiv.style.display = 'none';
                btnNovaFoto.style.display = 'none';
                btnLigarCamera.disabled = false;
                btnLigarCamera.textContent = 'üé• Ligar C√¢mera';
                btnCapturarFoto.disabled = true;
                photoStatus.textContent = 'Aguardando captura da foto...';
                photoStatus.style.color = '#666';
            });
            
            // Formatar CPF
            document.getElementById('cpfFuncionario').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                
                if (value.length > 11) value = value.substring(0, 11);
                
                if (value.length > 9) {
                    value = value.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/, '$1.$2.$3-$4');
                } else if (value.length > 6) {
                    value = value.replace(/(\d{3})(\d{3})(\d{1,3})/, '$1.$2.$3');
                } else if (value.length > 3) {
                    value = value.replace(/(\d{3})(\d{1,3})/, '$1.$2');
                }
                
                e.target.value = value;
            });
            
            // Formatar telefone
            document.getElementById('telefoneFuncionario').addEventListener('input', function(e) {
                let value = e.target.value.replace(/\D/g, '');
                
                if (value.length > 11) value = value.substring(0, 11);
                
                if (value.length > 10) {
                    value = value.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
                } else if (value.length > 6) {
                    value = value.replace(/(\d{2})(\d{4})(\d{0,4})/, '($1) $2-$3');
                } else if (value.length > 2) {
                    value = value.replace(/(\d{2})(\d{0,5})/, '($1) $2');
                }
                
                e.target.value = value;
            });
            
            // Enviar formul√°rio
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Verificar se foto foi capturada
                if (!fotoInput.value) {
                    alert('‚ùå √â OBRIGAT√ìRIO capturar a foto para reconhecimento facial!');
                    document.getElementById('btnLigarCamera').scrollIntoView({ behavior: 'smooth' });
                    return;
                }
                
                // Coletar dados
                const funcionario = {
                    id: Date.now(),
                    nome: document.getElementById('nomeFuncionario').value,
                    cpf: document.getElementById('cpfFuncionario').value,
                    email: document.getElementById('emailFuncionario').value,
                    telefone: document.getElementById('telefoneFuncionario').value,
                    cargo: document.getElementById('cargoFuncionario').value,
                    departamento: document.getElementById('departamentoFuncionario').value,
                    admissao: document.getElementById('admissaoFuncionario').value,
                    salario: document.getElementById('salarioFuncionario').value || 0,
                    foto: fotoInput.value,
                    cadastradoPor: localStorage.getItem('gestor_email'),
                    dataCadastro: new Date().toISOString(),
                    ativo: true
                };
                
                // Salvar no localStorage (substituir por Firebase depois)
                let funcionarios = JSON.parse(localStorage.getItem('funcionarios') || '[]');
                funcionarios.push(funcionario);
                localStorage.setItem('funcionarios', JSON.stringify(funcionarios));
                
                // Limpar formul√°rio
                form.reset();
                btnNovaFoto.click(); // Resetar foto
                
                // Mostrar mensagem de sucesso
                const messageDiv = document.getElementById('cadastroMessage');
                messageDiv.innerHTML = `
                    ‚úÖ Funcion√°rio <strong>${funcionario.nome}</strong> cadastrado com sucesso!<br>
                    <small>A foto foi salva para reconhecimento facial.</small>
                `;
                messageDiv.className = 'alert alert-success';
                
                // Atualizar dashboard
                carregarDashboard();
                
                // Ir para lista de funcion√°rios
                setTimeout(() => {
                    abrirAba('funcionarios');
                    carregarFuncionarios();
                }, 1500);
            });
        }
        
        // ==================== LISTA DE FUNCION√ÅRIOS ====================
        function carregarFuncionarios() {
            const funcionarios = JSON.parse(localStorage.getItem('funcionarios') || '[]');
            const container = document.getElementById('listaFuncionarios');
            const searchInput = document.getElementById('searchFuncionario');
            
            function renderizarLista(lista) {
                if (lista.length === 0) {
                    container.innerHTML = `
                        <div class="no-data">
                            <div>üë•</div>
                            Nenhum funcion√°rio encontrado.<br>
                            <button class="btn-gestor" onclick="abrirAba('cadastro')" 
                                    style="margin-top: 15px; padding: 10px 20px;">
                                üë§ Cadastrar Novo Funcion√°rio
                            </button>
                        </div>
                    `;
                    return;
                }
                
                container.innerHTML = lista.map(func => `
                    <div class="funcionario-card">
                        <img src="${func.foto}" 
                             alt="${func.nome}" 
                             class="funcionario-foto"
                             onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI0MCIgY3k9IjQwIiByPSI0MCIgZmlsbD0iI0U4RjVFOSIvPjxjaXJjbGUgY3g9IjQwIiBjeT0iMzAiIHI9IjE1IiBmaWxsPSIjMkU4QjU3Ii8+PHBhdGggZD0iTTIwIDYwSDE2MEMxNzAgNjAgMTgwIDcwIDE4MCA4MFYyMEMxODAgMzAgMTcwIDQwIDE2MCA0MEgyMEMxMCA0MCAwIDMwIDAgMjBWODBDMCA3MCAxMCA2MCAyMCA2MFoiIGZpbGw9IiMyRThCNTciLz48L3N2Zz4='">
                        <div class="funcionario-info">
                            <div class="funcionario-nome">${func.nome}</div>
                            <div class="funcionario-detalhes">
                                <strong>CPF:</strong> ${func.cpf}<br>
                                <strong>Cargo:</strong> ${func.cargo}<br>
                                <strong>Departamento:</strong> ${func.departamento}<br>
                                <strong>Admiss√£o:</strong> ${new Date(func.admissao).toLocaleDateString('pt-BR')}<br>
                                <strong>Status:</strong> 
                                <span style="color: ${func.ativo ? '#4CAF50' : '#f44336'}; font-weight: bold;">
                                    ${func.ativo ? '‚úÖ Ativo' : '‚ùå Inativo'}
                                </span>
                            </div>
                        </div>
                        <div style="margin-top: 15px; display: flex; gap: 10px;">
                            <button class="btn-gestor" onclick="editarFuncionario(${func.id})" 
                                    style="padding: 8px 15px; font-size: 14px;">
                                ‚úèÔ∏è Editar
                            </button>
                            <button class="btn-gestor btn-danger" onclick="excluirFuncionario(${func.id})" 
                                    style="padding: 8px 15px; font-size: 14px;">
                                üóëÔ∏è Excluir
                            </button>
                        </div>
                    </div>
                `).join('');
            }
            
            // Renderizar inicial
            renderizarLista(funcionarios);
            
            // Filtro de busca
            searchInput.addEventListener('input', function() {
                const termo = this.value.toLowerCase();
                const filtrados = funcionarios.filter(func => 
                    func.nome.toLowerCase().includes(termo) ||
                    func.cpf.includes(termo) ||
                    func.cargo.toLowerCase().includes(termo) ||
                    func.departamento.toLowerCase().includes(termo)
                );
                renderizarLista(filtrados);
            });
        }
        
        // ==================== FUN√á√ïES DO SISTEMA ====================
        function editarFuncionario(id) {
            alert(`Editar funcion√°rio ID: ${id}\n\nEsta funcionalidade est√° em desenvolvimento.`);
        }
        
        function excluirFuncionario(id) {
            if (confirm('Tem certeza que deseja excluir este funcion√°rio?\n\nEsta a√ß√£o n√£o pode ser desfeita.')) {
                let funcionarios = JSON.parse(localStorage.getItem('funcionarios') || '[]');
                funcionarios = funcionarios.filter(func => func.id !== id);
                localStorage.setItem('funcionarios', JSON.stringify(funcionarios));
                carregarFuncionarios();
                carregarDashboard();
            }
        }
        
        function carregarPontos() {
            // Simular dados de ponto
            const hoje = document.getElementById('dataPonto').value;
            const depto = document.getElementById('departamentoPonto').value;
            
            document.getElementById('tabelaPontos').innerHTML = `
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #E8F5E9;">
                                <th style="padding: 12px; text-align: left;">Funcion√°rio</th>
                                <th style="padding: 12px; text-align: left;">Entrada</th>
                                <th style="padding: 12px; text-align: left;">Sa√≠da</th>
                                <th style="padding: 12px; text-align: left;">Horas</th>
                                <th style="padding: 12px; text-align: left;">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 12px; border-bottom: 1px solid #E8F5E9;">Jo√£o Silva</td>
                                <td style="padding: 12px; border-bottom: 1px solid #E8F5E9;">08:00</td>
                                <td style="padding: 12px; border-bottom: 1px solid #E8F5E9;">18:00</td>
                                <td style="padding: 12px; border-bottom: 1px solid #E8F5E9;">10h00</td>
                                <td style="padding: 12px; border-bottom: 1px solid #E8F5E9;">
                                    <span style="color: #4CAF50; font-weight: bold;">‚úÖ Normal</span>
                                </td>
                            </tr>
                            <tr>
                                <td style="padding: 12px; border-bottom: 1px solid #E8F5E9;">Maria Santos</td>
                                <td style="padding: 12px; border-bottom: 1px solid #E8F5E9;">08:15</td>
                                <td style="padding: 12px; border-bottom: 1px solid #E8F5E9;">17:45</td>
                                <td style="padding: 12px; border-bottom: 1px solid #E8F5E9;">9h30</td>
                                <td style="padding: 12px; border-bottom: 1px solid #E8F5E9;">
                                    <span style="color: #FF9800; font-weight: bold;">‚ö†Ô∏è Atraso</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="margin-top: 20px; color: #666; font-size: 0.9rem;">
                    Mostrando dados de: <strong>${hoje}</strong> | 
                    Departamento: <strong>${depto === 'todos' ? 'Todos' : depto.toUpperCase()}</strong>
                </div>
            `;
        }
        
        function gerarRelatorio(tipo) {
            alert(`Gerando relat√≥rio ${tipo}...\n\nEm produ√ß√£o, esta fun√ß√£o geraria um PDF/Excel.`);
        }
        
        function gerarRelatorioPersonalizado() {
            alert('Relat√≥rio personalizado ser√° gerado...');
        }
        
        function exportarFuncionarios() {
            const funcionarios = JSON.parse(localStorage.getItem('funcionarios') || '[]');
            const csv = funcionarios.map(f => 
                `"${f.nome}","${f.cpf}","${f.cargo}","${f.departamento}","${f.admissao}"`
            ).join('\n');
            
            const blob = new Blob([`Nome,CPF,Cargo,Departamento,Admiss√£o\n${csv}`], 
                                 { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `funcionarios_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function backupDados() {
            alert('Backup dos dados realizado com sucesso!');
        }
        
        function limparCache() {
            if (confirm('Deseja limpar o cache do sistema?')) {
                localStorage.removeItem('funcionarios');
                localStorage.removeItem('pontos');
                location.reload();
            }
        }
        
        function resetarSistema() {
            if (confirm('‚ö†Ô∏è ATEN√á√ÉO: Esta a√ß√£o ir√° resetar TODOS os dados do sistema.\n\nDeseja continuar?')) {
                localStorage.clear();
                alert('Sistema resetado com sucesso!');
                window.location.href = 'index.html';
            }
        }
        
        function atualizarSistema() {
            localStorage.setItem('system_version', 'NOVA_VERSION');
            alert('Sistema marcado para atualiza√ß√£o. Recarregando...');
            setTimeout(() => location.reload(), 1000);
        }
        
        function abrirConfiguracoes() {
            abrirAba('config');
        }
        
        function gerarRelatorioDiario() {
            gerarRelatorio('diario');
        }
    </script>
</body>
</html>
