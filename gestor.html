<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel do Gestor - Essencial Print</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <!-- CONFIGURAÇÃO FIREBASE DIRETA (ADICIONADA) -->
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBNe8ryLTnb-IJBzR9CCmJ9Ljg_lawzTtk",
            authDomain: "essencial-print-5a753.firebaseapp.com",
            projectId: "essencial-print-5a753",
            storageBucket: "essencial-print-5a753.firebasestorage.app",
            messagingSenderId: "544082416072",
            appId: "1:544082416072:web:85d3c8549b25158284f0fd"
        };
    </script>
    
    <!-- Configuração Firebase -->
    <script src="js/firebase-config.js"></script>
    
    <!-- Script do Gestor -->
    <script src="js/gestor.js" defer></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 100%);
            color: #333;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 5px solid #2e7d32;
        }

        .logo h1 {
            color: #1b5e20;
            font-size: 28px;
            font-weight: 700;
        }

        .logo span {
            color: #388e3c;
            font-weight: 300;
        }

        .user-info h3 {
            color: #1b5e20;
            font-size: 20px;
            margin-bottom: 5px;
        }

        .user-info p {
            color: #666;
            font-size: 14px;
        }

        .btn-logout {
            background: #d32f2f;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
            transition: background 0.3s;
        }

        .btn-logout:hover {
            background: #b71c1c;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 25px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-top: 4px solid #4caf50;
        }

        .card h2 {
            color: #1b5e20;
            font-size: 22px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #c8e6c9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #2e7d32;
            color: white;
        }

        .btn-primary:hover {
            background: #1b5e20;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-success {
            background: #4caf50;
            color: white;
        }

        .btn-success:hover {
            background: #388e3c;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .btn-danger {
            background: #f44336;
            color: white;
        }

        .btn-danger:hover {
            background: #d32f2f;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            color: #1b5e20;
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 2px solid #c8e6c9;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #4caf50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        /* Estatísticas */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-card {
            background: #e8f5e8;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border-left: 4px solid #2e7d32;
        }

        .stat-number {
            font-size: 32px;
            font-weight: 700;
            color: #1b5e20;
            margin: 10px 0;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
        }

        /* Tabelas */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background-color: #e8f5e8;
            color: #1b5e20;
            font-weight: 600;
        }

        tbody tr:hover {
            background-color: #f5f5f5;
        }

        /* Badges de status */
        .status-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-presente {
            background: #c8e6c9;
            color: #1b5e20;
        }

        .status-atrasado {
            background: #fff3cd;
            color: #856404;
        }

        .status-falta {
            background: #f8d7da;
            color: #721c24;
        }

        .status-inativo {
            background: #e9ecef;
            color: #495057;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            border-top: 5px solid #4caf50;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h3 {
            color: #1b5e20;
            margin: 0;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .close-modal:hover {
            color: #f44336;
        }

        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        /* Tabs */
        .tab-navigation {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #c8e6c9;
        }

        .tab-btn {
            padding: 10px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            border-bottom: 3px solid transparent;
        }

        .tab-btn.active {
            color: #1b5e20;
            border-bottom: 3px solid #1b5e20;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Search */
        .search-box {
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
            padding: 12px;
            border: 2px solid #c8e6c9;
            border-radius: 8px;
            font-size: 14px;
        }

        /* Footer */
        footer {
            text-align: center;
            color: white;
            padding: 20px;
            font-size: 14px;
            opacity: 0.9;
        }

        footer p:first-child {
            font-weight: 600;
        }

        /* Responsivo */
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .user-info {
                text-align: center;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <h1>Essencial<span>Print</span></h1>
            </div>
            <div class="user-info">
                <h3 id="userName">Gestor</h3>
                <p id="userCargo">Painel Administrativo</p>
                <button class="btn-logout" onclick="logout()">Sair</button>
            </div>
        </header>

        <div class="dashboard">
            <!-- Estatísticas -->
            <div class="card">
                <h2>Estatísticas Gerais</h2>
                <div class="stats-grid" id="statsGrid">
                    <div class="stat-card">
                        <div class="stat-number">0</div>
                        <div class="stat-label">Funcionários</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">0</div>
                        <div class="stat-label">Registros Hoje</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">0</div>
                        <div class="stat-label">Pendentes</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">0</div>
                        <div class="stat-label">Ajustes/Mês</div>
                    </div>
                </div>
            </div>

            <!-- Funcionários Ativos -->
            <div class="card">
                <h2>Funcionários 
                    <button class="btn btn-success" onclick="openModal('novoFuncionario')">Novo</button>
                    <button class="btn btn-primary" onclick="carregarFuncionarios()" title="Atualizar">Atualizar</button>
                </h2>
                <div class="search-box">
                    <input type="text" id="searchFuncionarios" placeholder="Buscar funcionário..." onkeyup="filtrarFuncionarios()">
                </div>
                <div style="max-height: 400px; overflow-y: auto;">
                    <table id="tabelaFuncionarios">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Email</th>
                                <th>Cargo</th>
                                <th>Status</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td colspan="5" style="text-align: center;">Carregando funcionários...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Ajuste de Horas -->
            <div class="card">
                <h2>Ajuste de Horas 
                    <button class="btn btn-primary" onclick="openModal('ajusteHoras')">
                        Novo Ajuste
                    </button>
                </h2>
                <p style="color: #666; margin-bottom: 15px;">Ajuste horas trabalhadas externamente</p>
                
                <div style="background: #f0f8ff; padding: 15px; border-radius: 10px;">
                    <h4 style="color: #1b5e20; margin-bottom: 10px;">Últimos Ajustes</h4>
                    <div style="max-height: 200px; overflow-y: auto;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Funcionário</th>
                                    <th>Data</th>
                                    <th>Horas</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="tabelaAjustes">
                                <tr><td colspan="4" style="text-align: center;">Carregando...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Registros do Dia -->
            <div class="card">
                <h2>Registros de Hoje</h2>
                <div style="max-height: 400px; overflow-y: auto;">
                    <table id="tabelaRegistros">
                        <thead>
                            <tr>
                                <th>Funcionário</th>
                                <th>Horário</th>
                                <th>Tipo</th>
                                <th>Localização</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td colspan="4" style="text-align: center;">Carregando registros...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Relatórios -->
        <div class="card" style="margin-bottom: 25px;">
            <h2>Relatórios</h2>
            <div class="tab-navigation">
                <button class="tab-btn active" onclick="openTab('relatorioMensal')">Mensal</button>
                <button class="tab-btn" onclick="openTab('relatorioFuncionario')">Por Funcionário</button>
                <button class="tab-btn" onclick="openTab('relatorioAjustes')">Ajustes</button>
            </div>
            
            <div id="relatorioMensal" class="tab-content active">
                <div class="form-group">
                    <label for="mesRelatorio">Mês:</label>
                    <input type="month" id="mesRelatorio" class="form-control" onchange="gerarRelatorioMensal()">
                </div>
                <div id="relatorioMensalContent">
                    <p style="color: #666;">Selecione um mês para gerar o relatório</p>
                </div>
            </div>
            
            <div id="relatorioFuncionario" class="tab-content">
                <div class="form-group">
                    <label for="funcionarioRelatorio">Funcionário:</label>
                    <select id="funcionarioRelatorio" class="form-control" onchange="gerarRelatorioFuncionario()">
                        <option value="">Selecione um funcionário</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="periodoRelatorio">Período:</label>
                    <input type="month" id="periodoRelatorio" class="form-control" onchange="gerarRelatorioFuncionario()">
                </div>
                <div id="relatorioFuncionarioContent">
                    <p style="color: #666;">Selecione um funcionário e período</p>
                </div>
            </div>
            
            <div id="relatorioAjustes" class="tab-content">
                <div class="form-group">
                    <label for="periodoAjustes">Período:</label>
                    <input type="month" id="periodoAjustes" class="form-control" onchange="gerarRelatorioAjustes()">
                </div>
                <div id="relatorioAjustesContent">
                    <p style="color: #666;">Selecione um período para ver os ajustes</p>
                </div>
            </div>
        </div>

        <footer>
            <p>Essencial Print &copy; 2024 - Painel Administrativo</p>
            <p>Acesso restrito a gestores autorizados</p>
        </footer>
    </div>

    <!-- MODAL NOVO FUNCIONÁRIO -->
    <div id="modalNovoFuncionario" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Cadastrar Novo Funcionário</h3>
                <button class="close-modal" onclick="closeModal('novoFuncionario')">×</button>
            </div>
            <form id="formNovoFuncionario" onsubmit="return false;">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="nomeFuncionario">Nome Completo *</label>
                        <input type="text" id="nomeFuncionario" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="emailFuncionario">E-mail *</label>
                        <input type="email" id="emailFuncionario" class="form-control" required>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="senhaFuncionario">Senha *</label>
                        <input type="password" id="senhaFuncionario" class="form-control" required>
                        <small style="color: #666; font-size: 12px;">Mínimo 6 caracteres</small>
                    </div>
                    <div class="form-group">
                        <label for="cpfFuncionario">CPF *</label>
                        <input type="text" id="cpfFuncionario" class="form-control" placeholder="000.000.000-00" required>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="cargoFuncionario">Cargo *</label>
                        <select id="cargoFuncionario" class="form-control" required>
                            <option value="">Selecione...</option>
                            <option value="Operador">Operador</option>
                            <option value="Designer">Designer</option>
                            <option value="Atendente">Atendente</option>
                            <option value="Auxiliar">Auxiliar</option>
                            <option value="Supervisor">Supervisor</option>
                            <option value="Gerente">Gerente</option>
                            <option value="Outro">Outro</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="departamentoFuncionario">Departamento *</label>
                        <select id="departamentoFuncionario" class="form-control" required>
                            <option value="">Selecione...</option>
                            <option value="Produção">Produção</option>
                            <option value="Atendimento">Atendimento</option>
                            <option value="Design">Design</option>
                            <option value="Administração">Administração</option>
                            <option value="RH">RH</option>
                            <option value="Financeiro">Financeiro</option>
                            <option value="Comercial">Comercial</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="salarioFuncionario">Salário (R$)</label>
                        <input type="number" id="salarioFuncionario" class="form-control" step="0.01" placeholder="0,00">
                    </div>
                    <div class="form-group">
                        <label for="dataAdmissao">Data de Admissão *</label>
                        <input type="date" id="dataAdmissao" class="form-control" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="telefoneFuncionario">Telefone</label>
                    <input type="text" id="telefoneFuncionario" class="form-control" placeholder="(11) 99999-9999">
                </div>
                
                <div class="form-group">
                    <label for="enderecoFuncionario">Endereço</label>
                    <textarea id="enderecoFuncionario" class="form-control" rows="2" placeholder="Rua, Número, Bairro, Cidade"></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="button" class="btn btn-success" onclick="cadastrarFuncionario()" style="flex: 1;">
                        Cadastrar
                    </button>
                    <button type="button" class="btn btn-danger" onclick="closeModal('novoFuncionario')" style="flex: 1;">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL AJUSTE DE HORAS -->
    <div id="modalAjusteHoras" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Ajuste de Horas Trabalhadas</h3>
                <button class="close-modal" onclick="closeModal('ajusteHoras')">×</button>
            </div>
            <form id="formAjusteHoras" onsubmit="return false;">
                <div class="form-group">
                    <label for="funcionarioAjuste">Funcionário *</label>
                    <select id="funcionarioAjuste" class="form-control" required onchange="carregarHorarioAtual()">
                        <option value="">Selecione um funcionário</option>
                    </select>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="dataAjuste">Data *</label>
                        <input type="date" id="dataAjuste" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="tipoAjuste">Tipo de Ajuste *</label>
                        <select id="tipoAjuste" class="form-control" required>
                            <option value="">Selecione...</option>
                            <option value="trabalho_externo">Trabalho Externo</option>
                            <option value="hora_extra">Hora Extra</option>
                            <option value="falta_justificada">Falta Justificada</option>
                            <option value="atraso_justificado">Atraso Justificado</option>
                            <option value="compensacao">Compensação de Horas</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="horaEntradaAjuste">Hora de Entrada *</label>
                        <input type="time" id="horaEntradaAjuste" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="horaSaidaAjuste">Hora de Saída *</label>
                        <input type="time" id="horaSaidaAjuste" class="form-control" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="totalHorasAjuste">Total de Horas</label>
                    <input type="text" id="totalHorasAjuste" class="form-control" readonly style="background: #f5f5f5;">
                    <small style="color: #666; font-size: 12px;">Calculado automaticamente</small>
                </div>
                
                <div class="form-group">
                    <label for="justificativaAjuste">Justificativa *</label>
                    <textarea id="justificativaAjuste" class="form-control" rows="3" 
                              placeholder="Descreva o motivo do ajuste (ex: Trabalho externo sem acesso à internet)" required></textarea>
                </div>
                
                <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin-top: 15px;">
                    <h4 style="color: #2e7d32; margin-bottom: 10px;">Horários Registrados para esta data:</h4>
                    <div id="horariosExistentes">
                        <p style="color: #666;">Selecione um funcionário e data para ver os horários</p>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="button" class="btn btn-success" onclick="salvarAjusteHoras()" style="flex: 1;">
                        Salvar Ajuste
                    </button>
                    <button type="button" class="btn btn-primary" onclick="calcularHoras()" style="flex: 1;">
                        Calcular Horas
                    </button>
                    <button type="button" class="btn btn-danger" onclick="closeModal('ajusteHoras')" style="flex: 1;">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL EDITAR FUNCIONÁRIO -->
    <div id="modalEditarFuncionario" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Editar Funcionário</h3>
                <button class="close-modal" onclick="closeModal('editarFuncionario')">×</button>
            </div>
            <form id="formEditarFuncionario" onsubmit="return false;">
                <input type="hidden" id="editarFuncionarioId">
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="editarNome">Nome Completo *</label>
                        <input type="text" id="editarNome" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="editarEmail">E-mail *</label>
                        <input type="email" id="editarEmail" class="form-control" required>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="editarCpf">CPF *</label>
                        <input type="text" id="editarCpf" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="editarCargo">Cargo *</label>
                        <input type="text" id="editarCargo" class="form-control" required>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="editarDepartamento">Departamento *</label>
                        <input type="text" id="editarDepartamento" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label>Status</label>
                        <div style="display: flex; gap: 15px; margin-top: 8px;">
                            <label>
                                <input type="radio" name="editarStatus" value="ativo" checked> Ativo
                            </label>
                            <label>
                                <input type="radio" name="editarStatus" value="inativo"> Inativo
                            </label>
                        </div>
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="button" class="btn btn-success" onclick="atualizarFuncionario()" style="flex: 1;">
                        Salvar Alterações
                    </button>
                    <button type="button" class="btn btn-danger" onclick="closeModal('editarFuncionario')" style="flex: 1;">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Funções básicas de interface
        function openModal(modalName) {
            const modalElement = document.getElementById(`modal${modalName.charAt(0).toUpperCase() + modalName.slice(1)}`);
            if (modalElement) {
                modalElement.style.display = 'flex';
            }
        }

        function closeModal(modalName) {
            const modalElement = document.getElementById(`modal${modalName.charAt(0).toUpperCase() + modalName.slice(1)}`);
            if (modalElement) {
                modalElement.style.display = 'none';
                
                if (modalName === 'novoFuncionario') {
                    document.getElementById('formNovoFuncionario').reset();
                }
                if (modalName === 'ajusteHoras') {
                    document.getElementById('formAjusteHoras').reset();
                    document.getElementById('totalHorasAjuste').value = '';
                    document.getElementById('horariosExistentes').innerHTML = 
                        '<p style="color: #666;">Selecione um funcionário e data para ver os horários</p>';
                }
            }
        }

        function openTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const tabElement = document.getElementById(tabName);
            if (tabElement) {
                tabElement.classList.add('active');
            }
            if (event && event.target) {
                event.target.classList.add('active');
            }
        }

        function calcularHoras() {
            const entrada = document.getElementById('horaEntradaAjuste')?.value;
            const saida = document.getElementById('horaSaidaAjuste')?.value;
            
            if (!entrada || !saida) {
                if (document.getElementById('totalHorasAjuste')) {
                    document.getElementById('totalHorasAjuste').value = '';
                }
                return;
            }
            
            const [h1, m1] = entrada.split(':').map(Number);
            const [h2, m2] = saida.split(':').map(Number);
            
            const entradaDate = new Date(0, 0, 0, h1, m1);
            const saidaDate = new Date(0, 0, 0, h2, m2);
            
            const diffMs = saidaDate - entradaDate;
            const diffMinutes = Math.floor(diffMs / 60000);
            
            const horas = Math.floor(diffMinutes / 60);
            const minutos = diffMinutes % 60;
            
            if (document.getElementById('totalHorasAjuste')) {
                document.getElementById('totalHorasAjuste').value = `${horas}:${minutos.toString().padStart(2, '0')}`;
            }
        }

        function filtrarFuncionarios() {
            const input = document.getElementById('searchFuncionarios')?.value.toLowerCase() || '';
            const rows = document.querySelectorAll('#tabelaFuncionarios tbody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(input) ? '' : 'none';
            });
        }

        function logout() {
            if (confirm('Deseja realmente sair?')) {
                localStorage.removeItem('usuario_logado');
                localStorage.removeItem('funcionario_logado');
                window.location.href = 'index.html';
            }
        }
        
        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            const hoje = new Date().toISOString().split('T')[0];
            const mesAtual = new Date().toISOString().slice(0, 7);
            
            if (document.getElementById('mesRelatorio')) {
                document.getElementById('mesRelatorio').value = mesAtual;
                document.getElementById('periodoRelatorio').value = mesAtual;
                document.getElementById('periodoAjustes').value = mesAtual;
            }
            
            if (document.getElementById('dataAdmissao')) {
                document.getElementById('dataAdmissao').value = hoje;
            }
            
            if (document.getElementById('dataAjuste')) {
                document.getElementById('dataAjuste').value = hoje;
            }
            
            const entradaInput = document.getElementById('horaEntradaAjuste');
            const saidaInput = document.getElementById('horaSaidaAjuste');
            
            if (entradaInput && saidaInput) {
                entradaInput.addEventListener('change', calcularHoras);
                saidaInput.addEventListener('change', calcularHoras);
            }
        });
    </script>
</body>
</html>
